# 中间代码生成


三地址代码: 一条指令的右侧最多有一个运算符。像x + y * z翻译成如下的三地址指令序列

```
t1 = y * z
t2 = x + t1 
```



一个四元式有四个字段， 分别称为op, arg1, arg2, result。 四元式表示:  ```x = y + z ``` 
对应的四元式为 ```  op 存放 + ， arg1 存放 y , arg2存放 z, result存放x```


三元式只有三个字段, 分别称之为 ```op, arg1, arg2 ``` 

## 静态单赋值形式
静态单赋值形式(SSA)是另一种中间表示形式, 它有利于实现某些类型的代码优化。 SSA与三地址代码的区别主要体现在两个方面:
1. SSA中的所有赋值都是针对具有不同名字的变量的
2. SSA使用一种称为𝛗函数的表示规则将x的两处定值合并起来 

## 类型推导

类型检查有两种形式: 综合和推导。 

- 类型综合根据子表达式的类型构造出表达式的类型， 它要求名字先声明再使用。 
- 类型推导根据一个语言结构的使用方式来确定该结构的类型。 

### 类型合一算法

输入: 一个表示类型的图， 以及需要进行合一处理的结点对 m 和 n

输出: 如果结点m 和 n 表示的表达式可以合一, 返回true, 反之返回false.

实现步骤:

1. 结点用一个记录实现， 记录中的字段用于存放一个二元计算符和分别指向其左右子结点的指针。 
2. 字段set用于保存等价结点的集合
3. 每个等价类都有一个结点被选作这个类的唯一代表， 它的set字段包含一个空指针。 

## 回填

它把一个由跳转指令组成的列表以综合属性的形式进行传递, 明确地讲， 生成一个跳转指令时暂时不指定该跳转指令的目标。
